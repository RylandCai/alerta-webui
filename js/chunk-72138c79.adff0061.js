(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72138c79"],{"8cc8":function(t,e,r){"use strict";var s=r("c315"),n=r.n(s);n.a},c315:function(t,e,r){},ed05:function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-card",{staticClass:"alert-indicator",on:{click:function(e){return t.selectAsi()}}},[r("v-card-text",{staticClass:"pa-0",style:{"background-color":t.severityColor(t.maxSeverity)}},[r("div",{staticClass:"text-uppercase text-xs-center py-2"},[t._v("\n      "+t._s(t.title)+"\n    ")])]),r("v-card-actions",{staticClass:"pa-0 mx-0",style:{"background-color":t.isDark?"":"#F5F5F5"}},[r("v-layout",[r("v-flex",[r("div",{staticClass:"counts-container"},[t.counts?r("v-layout",{attrs:{"align-start":"","justify-space-between":""}},t._l(t.$config.indicators.severity,(function(e){return r("div",{key:e,staticClass:"count text-xs-center py-2",style:{"background-color":t.severityColor(e)}},[t._v("\n              "+t._s(t.counts[e]||0)+"\n            ")])})),0):t._e()],1)])],1)],1)],1)},n=[],i=(r("ac4d"),r("8a81"),r("ac6a"),r("4e08")),a={props:{title:{type:String,default:""},query:{type:[String,Array,Object],default:""}},data:function(){return{counts:null,openCounts:null,maxSeverity:null,timer:null}},computed:{isDark:function(){return this.$store.getters.getPreference("isDark")},refresh:function(){return this.$store.state.refresh},refreshInterval:function(){return this.$store.getters.getPreference("refreshInterval")||this.$store.getters.getConfig("refresh_interval")}},watch:{refresh:function(t){t&&(this.getMostSevere(),this.getCounts())}},created:function(){this.cancelTimer(),this.refreshCounts()},beforeDestroy:function(){this.cancelTimer()},methods:{selectAsi:function(){this.setSearch(new URLSearchParams(this.query)),this.setFilter(new URLSearchParams(this.query)),this.refreshList()},setSearch:function(t){this.$store.dispatch("alerts/updateQuery",t)},setFilter:function(t){this.$store.dispatch("alerts/setFilter",{environment:t.get("environment"),text:t.get("text"),status:t.has("status")?t.getAll("status"):null,customer:t.has("customer")?t.getAll("customer"):null,service:t.has("service")?t.getAll("service"):null,group:t.has("group")?t.getAll("group"):null})},severityColor:function(t){return this.counts&&this.counts[t]>0?this.$store.getters.getConfig("colors").severity[t]:"transparent"},getCounts:function(){var t=this;return i["a"].getCounts(new URLSearchParams(this.query)).then((function(e){return t.counts=e.severityCounts}))},getMostSevere:function(){var t=this,e=new URLSearchParams(this.query);e.append("status","open"),i["a"].getCounts(e).then((function(e){t.maxSeverity=t.$config.alarm_model.defaults.normal_severity;var r=!0,s=!1,n=void 0;try{for(var i,a=t.$config.indicators.severity[Symbol.iterator]();!(r=(i=a.next()).done);r=!0){var o=i.value;if(e.severityCounts[o]>0){t.maxSeverity=o;break}}}catch(c){s=!0,n=c}finally{try{r||null==a.return||a.return()}finally{if(s)throw n}}}))},refreshCounts:function(){var t=this;this.getMostSevere(),this.getCounts().then((function(){return t.timer=setTimeout((function(){return t.refreshCounts()}),t.refreshInterval)}))},refreshList:function(){var t=this;this.$store.dispatch("set",["refresh",!0]),setTimeout((function(){t.$store.dispatch("set",["refresh",!1])}),300)},cancelTimer:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}}},o=a,c=(r("8cc8"),r("2877")),u=r("6544"),l=r.n(u),h=r("b0af"),f=r("99d9"),v=r("0e8f"),y=r("a722"),d=Object(c["a"])(o,s,n,!1,null,"2fffb3c6",null);e["default"]=d.exports;l()(d,{VCard:h["a"],VCardActions:f["a"],VCardText:f["b"],VFlex:v["a"],VLayout:y["a"]})}}]);
//# sourceMappingURL=chunk-72138c79.adff0061.js.map